function showDiv(a,b){var c="#"+b+"explanation";$(c).length&&$(c).remove();var d=document.getElementById(b);if("pressed"==a.status)d.style.display="none",$(d).parent().parent().hide();else{d3.select("#".concat(b)).selectAll("svg").remove(),d.style.display="block",$(d).parent().parent().show();for(var e=document.querySelectorAll("td"),f=0;f<e.length;f++)"pressed"==e[f].status&&(e[f].status="released")}a.status="pressed"==a.status?"released":"pressed"}function AddExplanation(a,b,c){var d="#"+c+"row",e=$('<div id="'+c+'explanation" class="alert alert-info explanation_alert" role="alert"><b>Explanation:</b> '+b+"</div>");"pressed"==a.status&&$(d).prepend(e)}function addPlot(a,b,c,d,e,f,g,h,i){if(""==e)var j=[];else var j=e.split(";");switch(c){case"scatter":plot_scatter(b,a,d,e,f,g,h,i);break;case"bars":plot_bars(b,a,d,j,f,g,h);break;case"simplebars":plot_simple_bars(b,a,d,j,f,g);break;case"lines":""!=i&&(i=i.split(",")),plot_lines(b,a,d,j,f,g,h,i);break;case"align":""!=i&&(i=i.split(",")),plot_align(b,a,d,j,f,g,h,i)}}function color_beautification(a){switch(a){case"red":return d3.rgb(189,54,47);case"blue":return d3.rgb(58,135,173);case"green":return d3.rgb(70,136,71);case"yellow":return d3.rgb(255,255,51);case"orange":return d3.rgb(248,148,6);case"violet":return d3.rgb(153,0,153);case"gray":return d3.rgb(160,160,160);default:return a}}function plot_bars(a,b,c,d,e,f,g){var h={top:70,right:50,bottom:75,left:50},i=600-h.left-h.right,j=500-h.top-h.bottom,l=d3.select("#".concat(b)).append("svg").attr("width",i+h.left+h.right).attr("height",j+h.top+h.bottom).append("g").attr("transform","translate("+h.left+","+h.top+")");l.append("text").attr("x",i/2).attr("y",-45).attr("text-anchor","middle").style("font-size","16px").text(c);var m=new Array("orange","blue","green","yellow","brown"),n=m.length,o=100;d3.json(a,function(a,b){flattened_data=[].concat.apply([],b);var c=d3.max(flattened_data,function(a){return a.value})+3,d=d3.scale.linear().domain([0,c+c/10]).range([j,0]),h=d3.min(flattened_data,function(a){return a.key});if(void 0!=g)var h=Math.min(h,g);var k=d3.max(flattened_data,function(a){return a.key});if(void 0!=g)var k=Math.max(k,g);var p=d3.scale.linear().domain([h-o,k+o]).range([13,i]),q=d3.svg.axis().scale(p).orient("bottom").ticks(8),r=d3.svg.axis().scale(d).orient("left").tickFormat(d3.format("d")).ticks(8);l.append("g").attr("class","x axis").attr("transform","translate(0,"+j+")").call(q).append("text").attr("class","label").attr("x",(i-e.length)/2-50).attr("y",35).style("text-anchor","start").text(e),l.append("g").attr("class","y axis").call(r).append("text").attr("class","label").attr("transform","rotate(-90)").attr("x",-(j+f.length)/2-50).attr("y",-40).style("text-anchor","start").text(f),b.map(function(a,b){color=m[b%(n-1)],l.selectAll(".bar").data(a).enter().append("rect").attr("x",function(a){return p(a.key)}).attr("width",6).attr("y",function(a){return d(a.value)}).attr("height",function(a){return j-d(a.value)}).attr("fill",function(a){return 1==a.main?color_beautification("red"):color_beautification("blue")})}),void 0!=g&&(l.append("rect").attr("x",p(g)).attr("width",4).attr("y",d(c+c/10)).style("opacity",.6).attr("height",j-d(c+c/8)).attr("fill",color_beautification("black")),l.append("text").attr("transform","rotate(-90)").attr("x",-c/10-35).attr("y",p(g)-5).text("query"))});for(var p=0,q=0,r=0;r<d.length;r++){var s=d[r].split(",");q=q+8*s[0].length+15}for(var r=0;r<d.length;r++){var s=d[r].split(",");l.append("rect").attr("x",(i-q)/2+p).attr("y",-30).attr("width",10).attr("height",10).style("fill",color_beautification(s[1].replace(/\s+/g,""))),l.append("text").attr("x",(i-q)/2+p+15).attr("y",-20).text(s[0]),p=p+8*s[0].length+15}}function plot_simple_bars(a,b,c,d,e,f){var g={top:70,right:50,bottom:75,left:50},h=600-g.left-g.right,i=500-g.top-g.bottom,k=d3.select("#".concat(b)).append("svg").attr("width",h+g.left+g.right).attr("height",i+g.top+g.bottom).append("g").attr("transform","translate("+g.left+","+g.top+")");k.append("text").attr("x",h/2).attr("y",-45).attr("text-anchor","middle").style("font-size","16px").text(c);var l=new Array("orange","blue","green","yellow","brown"),m=l.length,n=0;d3.json(a,function(a,b){flattened_data=[].concat.apply([],b);var c=d3.max(flattened_data,function(a){return a.value})+3,d=d3.scale.linear().domain([0,c]).range([i,0]),g=d3.min(flattened_data,function(a){return a.key}),j=d3.max(flattened_data,function(a){return a.key}),o=d3.scale.linear().domain([g-n,j+n]).range([13,h]),p=d3.svg.axis().scale(o).orient("bottom").ticks(8),q=d3.svg.axis().scale(d).orient("left").tickFormat(d3.format("d")).ticks(8);k.append("g").attr("class","x axis").attr("transform","translate(0,"+i+")").call(p).append("text").attr("class","label").attr("x",(h-e.length)/2-50).attr("y",35).style("text-anchor","start").text(e),k.append("g").attr("class","y axis").call(q).append("text").attr("class","label").attr("transform","rotate(-90)").attr("x",-(i+f.length)/2-50).attr("y",-40).style("text-anchor","start").text(f),b.map(function(a,b){color=l[b%(m-1)],k.selectAll(".bar").data(a).enter().append("rect").attr("x",function(a){return o(a.key)}).attr("width",6).attr("y",function(a){return d(a.value)}).attr("height",function(a){return i-d(a.value)}).attr("fill",function(a){return 1==a.main?color_beautification("red"):color_beautification("blue")})})})}function plot_scatter(a,b,c,d,e,f,g,h){var i={top:50,right:30,bottom:75,left:50},j=500-i.left-i.right,k=500-i.top-i.bottom,l=d3.scale.linear().range([0,j]),m=d3.scale.linear().range([k,0]);d3.scale.category10();var o=d3.svg.axis().scale(l).orient("bottom").ticks(8),p=d3.svg.axis().scale(m).orient("left").tickFormat(d3.format("d")).ticks(8),q=d3.select("#".concat(b)).append("svg").attr("width",j+i.left+i.right).attr("height",k+i.top+i.bottom).append("g").attr("transform","translate("+i.left+","+i.top+")");q.append("text").attr("x",j/2).attr("y",-25).attr("text-anchor","middle").style("font-size","16px").text(c),q.append("text").attr("x",j/2).attr("y",k+55).attr("text-anchor","middle").style("font-size","12px").text(d),d3.json(a,function(a,b){var c=d3.max(b,function(a){return a.x}),d=d3.min(b,function(a){return a.x}),i=d3.max(b,function(a){return a.y}),n=d3.min(b,function(a){return a.y});if(l.domain(d3.extent(b,function(a){return a.x})).nice(),m.domain(d3.extent(b,function(a){return a.y})).nice(),q.append("g").attr("class","x axis").attr("transform","translate(0,"+k+")").call(o).append("text").attr("class","label").attr("x",(j-e.length)/2-50).attr("y",35).style("text-anchor","start").text(e),q.append("g").attr("class","y axis").call(p).append("text").attr("class","label").attr("transform","rotate(-90)").attr("x",-(k+f.length)/2-50).attr("y",-40).style("text-anchor","start").text(f),q.selectAll(".dot").data(b).enter().append("circle").attr("r",2).attr("cx",function(a){return l(a.x)}).attr("cy",function(a){return m(a.y)}).style("fill",function(){return color_beautification("red")}).style("opacity",.6),void 0!=h&&""!=h&&void 0!=g&&""!=g){g=parseFloat(g.replace(",","."));var r=c,s=g+h*c;s>i&&(r=(i-g)/h,s=i),n>s&&(r=(n-g)/h,s=n);var t=d,u=g+h*d;u>i&&(t=(i-g)/h,u=n),n>u&&(t=(n-g)/h,u=n),q.append("line").attr("x1",l(t)).attr("y1",m(u)).attr("x2",l(r)).attr("y2",m(s)).attr("stroke-width",2).attr("stroke","black")}})}function plot_lines(a,b,c,d,e,f,g,h){var i={top:50,right:50,bottom:75,left:50},j=600-i.left-i.right,k=500-i.top-i.bottom,l=17,m=d3.scale.linear().range([0,j]),n=d3.scale.linear().range([k,0]);if(d3.scale.category10(),"Open reading frame with STOP codon"===c)var p=d3.svg.axis().scale(m).orient("bottom").ticks(0);else var p=d3.svg.axis().scale(m).orient("bottom").ticks(5);var q=d3.svg.axis().scale(n).orient("left").ticks(5),r=d3.select("#".concat(b)).append("svg").attr("width",j+i.left+i.right).attr("height",k+i.top+i.bottom).append("g").attr("transform","translate("+i.left+","+i.top+")");r.append("text").attr("x",j/2).attr("y",-35).attr("text-anchor","middle").style("font-size","16px").text(c),d3.json(a,function(a,b){var c=-1;m.domain([0,d3.max(b,function(a){return a.stop})]),n.domain(d3.extent(b,function(a){return a.y})).nice(),r.append("g").attr("class","x axis").attr("transform","translate(0,"+(k+k/g)+")").call(p).append("text").attr("class","label").attr("x",(j-e.length)/2-50).attr("y",35).style("text-anchor","start").text(e),""!=h?r.append("g").attr("class","y axis").call(q.ticks(h.length).tickFormat(function(){return c+=1,h[c]})).append("text").attr("class","label").attr("transform","rotate(-90)").attr("x",-(k+f.length)/2-50).attr("y",-40).style("text-anchor","start").text(f):r.append("g").attr("class","y axis").call(q).append("text").attr("class","label").attr("transform","rotate(-90)").attr("x",-(k+f.length)/2).attr("y",-40).style("text-anchor","start").text(f),r.selectAll(".dot").data(b).enter().append("line").attr("x1",function(a){return m(a.start)}).attr("y1",function(a){return n(a.y)}).attr("x2",function(a){return m(a.stop)}).attr("x2",function(a){return m(a.stop)}).attr("y2",function(a){return n(a.y)}).attr("stroke-width",function(a){return void 0==a.dotted?"red"==a.color?k/g/2.5:k/g:k/g/5}).style("stroke-dasharray",function(a){return void 0==a.dotted?"0, 0":"2, 6"}).attr("stroke",function(a){return color_beautification(a.color)})});for(var s=r.append("g").attr("class","legend").attr("height",100).attr("width",100).attr("transform","translate(-20,50)"),t=0,u=0;u<d.length;u++){var v=d[u].split(",");s.append("rect").attr("x",j+i.left).attr("y",15*t).attr("width",10).attr("height",10).style("fill",color_beautification(v[1].replace(/\s+/g,"")));for(var w=l,x=v[0].length,y=0;x>y;y+=w){var z=v[0].substring(y,Math.min(x,y+w));s.append("text").attr("x",j+i.left+15).attr("y",15*t+9).text(z),t+=1}}}function plot_align(a,b,c,d,e,f,g,h){var i={top:75,right:50,bottom:75,left:150},j=600-i.left-i.right,k=300-i.top-i.bottom,m=d3.scale.linear().range([0,j]),n=d3.scale.linear().range([k,0]);d3.scale.category10();var p=d3.svg.axis().scale(m).orient("bottom").ticks(5),q=d3.svg.axis().scale(n).orient("left").ticks(5),r=d3.select("#".concat(b)).append("svg").style("vertical-align","top").attr("width",j+i.left+i.right).attr("height",k+i.top+i.bottom).append("g").attr("transform","translate("+i.left+","+i.top+")");r.append("text").attr("x",j/2).attr("y",-35).attr("text-anchor","middle").style("font-size","16px").text(c),d3.json(a,function(a,b){var c=-1;m.domain([0,d3.max(b,function(a){return a.stop})]),n.domain(d3.extent(b,function(a){return a.y})).nice(),r.append("g").attr("class","x axis").attr("transform","translate(0,"+(k+k/g)+")").call(p).append("text").attr("class","label").attr("x",(j-e.length)/2-50).attr("y",35).style("text-anchor","start").text(e),""!=h?r.append("g").attr("class","y axis").call(q.ticks(h.length).tickFormat(function(){return c+=1,h[c]})).append("text").attr("class","label").attr("transform","rotate(-90)").attr("x",-(k+f.length)/2-50).attr("y",-40).style("text-anchor","start").text(f):r.append("g").attr("class","y axis").call(q).append("text").attr("class","label").attr("transform","rotate(-90)").attr("x",-(k+f.length)/2-50).attr("y",-40).style("text-anchor","start").text(f),r.selectAll(".dot").data(b).enter().append("line").attr("x1",function(a){return m(a.start)}).attr("y1",function(a){return n(a.y)}).attr("x2",function(a){return m(a.stop)}).attr("y2",function(a){return n(a.y)}).attr("stroke-width",function(a){return-1==a.height?k/g:k/g*a.height}).attr("stroke",function(a){return color_beautification(a.color)})});for(var s=0,t=0,u=0;u<d.length;u++){var v=d[u].split(",");t=t+8*v[0].length+15}for(var u=0;u<d.length;u++){var v=d[u].split(",");r.append("rect").attr("x",(j-t)/2+s).attr("y",-30).attr("width",10).attr("height",10).style("fill",color_beautification(v[1].replace(/\s+/g,""))),r.append("text").attr("x",(j-t)/2+s+15).attr("y",-20).text(v[0]),s=s+8*v[0].length+15}}